---
title: 홈서버 구축기 (1)
date: 2025-12-17 14:30:00 +0900
categories: [ETC, Hobby]
tags: [server]
---

## 들어가며
남자라면 누구나 서버를 갖고 싶어한다. ~~(아마도...)~~ 나 역시 어렸을 때 부터 서버를 갖고 싶었다. 고등학생 때 친구들과 함께 게임 마인크래프트를 즐기기 위해 자주 서버를 열곤 했는데, 내 컴퓨터를 켜 놓아야만 친구들이 접속할 수 있다는 점이 불편하게 다가왔다. 

그래서 첫 가입 시 300달러의 무료 크레딧을 주는 GCP(구글 클라우드 플랫폼)에서 VM 인스턴스를 빌려 마인크래프트 서버를 운영해 보기도 하였고, 이후 한동안 비용을 지불해가며 서버를 유지했었다. 그 과정에서 자연스레 클라우드 컴퓨팅의 대한 개념과 원격 접속(SSH), 기본적인 리눅스 명령어 등에 대한 지식을 얻기도 하였다. 오라클 클라우드의 ARM 기반 Ampere 인스턴스는 평생 무료에 적절한 성능을 제공하기에 이를 노려보기도 하였으나, 무료 유저 풀이 항상 가득 차있어 쉽게 서비스를 사용할 수 없었다. 

매달 클라우드에 지불하는 비용을 따져보니, 결국 직접 서버 컴퓨터를 사서 돌리는게 더 이득이라는 판단을 내렸다. 물론 클라우드 서비스들은 다양한 기능들을 제공하고 안정성과 신뢰성 부분에서 월등하지만, 단순히 게임 서버를 호스팅하는 내 사용 수준에서는 굳이라는 생각이 들었다. 그래서 이번에 서버를 하나 들이기로 하였다.

## 목표
이 서버로 할 작업들은 다음과 같다.

1. 마인크래프트 서버 구동
2. 웹페이지(블로그 포함) 자체 호스팅
3. 앞으로 개발할 Findit 서비스 서버 호스팅
4. 영상 저장용 NAS 구축

## 하드웨어 구축
### 하드웨어 요구 사항
집에서 운영할 것이기 때문에, 서버 랙과 같은 형태는 너무 크고 부담스럽다. 내 방에는 이미 데스크탑이 한대 자리잡고 있기에, 일반 데스크탑 형태의 PC를 하나 더 추가하는 것 역시 부담스럽다. 컴팩트한 미니PC가 적합할 것이다.

웹페이지 호스팅과 NAS 운영은 큰 컴퓨팅 성능을 요구하지 않는다(네트워크 성능이 더 중요하다). 다만 마인크래프트 서버는 원활히 구동되기 위해서 일정 수준 이상의 컴퓨팅 파워를 요구한다. 따라서 너무 저사양의 컴퓨터는 이 서버용으로 적합하지 않다. 그러면서도 24시간 돌아가야 하기 때문에, 저전력으로 돌아갈 수 있어야 한다.

다만 마인크래프트 서버는 기본적으로 싱글스레드로 동작하기 때문에, 멀티스레드 성능보다는 싱글스레드 성능이 중요하다. 내 메인 PC로 사용중인 `R7 5800x`의 싱글스레드 성능이 Cinebench R23 기준 1600점인데, 이의 절반인 800점을 마지노선으로 했다.

동시접속자 10명 수준의 바닐라 마인크래프트 서버를 원활하게 구동하기 위해서는 서버 구동기에게 최소 4GB 이상의 메모리를 할당해야 한다. 다만 나는 넉넉하게 8GB를 주고 싶었고, 그 외에 다른 프로세스들도 메모리를 이용해야 하기에 메모리 용량은 16GB 이상으로 찾고자 했다.

정리하자면 다음과 같다. 

- 컴팩트한 사이즈로 방에 설치하기 적합할 것.
- Cinebench R23 기준 싱글스레드 점수 800점 이상의 성능을 낼 것.
- 저전력 설계로 온도와 소음, 전기세 측면에서 이득이 있을 것.
- 16GB 이상의 메모리를 설치할 수 있을 것.

### 적합한 모델 찾기
처음 고려하던 것은 인텔의 N100 기반의 미니PC를 이용하는 것이였다. 알리익스프레스 등지에서 10만원 중후반의 가격으로 구매할 수 있는데, 마인크래프트 서버를 구동할 수 있을 정도의 무난한 성능을 내주며, TDP 6W로 매우 적은 전력을 소모한다. Cinebench R23 기준 800 ~ 900점의 성능을 내준다. 다만 NAS로 사용하기 위해서는 고용량의 하드디스크(HDD)를 장착할 수 있어야 하는데, 2.5인치 또는 3.5인치 드라이브를 지원하는 미니PC의 선택지는 많지 않았다.

그러던 중 중고나라에서 완벽한 매물을 찾았다. 바로 Asrock의 Deskmini 310 이였다. 데스크미니 시리즈는 알리에서 판매하는 미니PC들보다는 크기가 큰 베어본이지만, 여전히 한 손바닥 위에 올릴 수 있을정도로 컴팩트하다. 이 매물의 가장 큰 장점은 가성비였다. 사양은 다음과 같았다.
- Asrock Deskmini 310
- i5-9600K
- Asrock h310m-stx
- 16GB LPDDR4 RAM
- 256GB M.2 SATA SSD

![Exciting](https://media.tenor.com/TQTVSmxhX5kAAAAj/apu-apustaja-apu.gif){: w="100"}
_신난다_

이 사양이 무려 **17만원**이였다. 중고 시장에서 i5-9600K만 8만원 수준인데다가, 현재 미쳐 날뛰는 메모리 가격을 생각해보면 사실상 거저 주는 것과 다름없었다. ~~(물론 여자친구가 알면 여전히 등짝을 맞을 소비이긴 하다..)~~ 

| CPU                  | N100 | i5-9600K | R7 5800X (메인 PC, 비교용) |
|----------------------|------|----------|----------|
| Cinebench R23 Single | 900  | 1200     | 1600     |
| Cinebench R23 Multi  | 3000 | 6600     | 15000    |

각 CPU들의 싱글스레드 성능을 표로 정리하면 위와 같다. 심지어 기존에 고민하던 N100에 비하면, i5-9600K의  싱글스레드 성능은 Cinebench R23 기준 1100점 ~ 1200점으로 30% 가까이 차이났다. 따라서 한치의 고민도 없이 판매자에게 연락해 구매하였다.

### 하드웨어 세팅하기
![Asrock Deskmini 310](/assets/img/deskmini.png){: w="500"}
_고우시다_

그렇게 서버용 PC가 배송되었다. Deskmini 310은 후면에 2.5인치 SATA 슬롯 2개를 지원한다. 현재는 256GB SSD 하나뿐이지만, 추후 고용량 2.5인치 HDD/SSD를 추가하여 NAS로서의 용량을 확보할 계획이다.

다만 문제가 있었는데, i5-9600K는 고성능 데스크탑 CPU로, TDP가 95W에 이른다는 점이였다. 해당 데스크미니 베어본은 파워와 메인보드 전원부는 최대 65W까지밖에 지원하지 않도록 설계되었기에, 잘못하다간 전원부가 과열되고 메인보드가 고장날 수도 있다. 게다가 95W의 전력소모는 인텔 기본쿨러로 온도를 감당하기도 어려울 것이다. 

따라서 바이오스 상에서 전력 제한을 걸기로 했다. CPU의 성능은 전력과 정비례하지 않는다. 예를 들면 전력을 50%로 제한한다고 해서 성능이 50%가 되는 것이 아니라, 80% 수준이 되는 것이다. 따라서 전력을 적절히 조정함으로써 전성비(전력 대 성능비)의 스윗스팟을 찾아낼 수 있다. 

바이오스 상에서 PL1 (Long Duration Power Limit)을 45W로, PL2 (Short Duration Power Limit)을 65W로 설정하였다. 이렇게 하면 일반적인 작업에서 45W 수준의 전력만을 사용할 것이며, 순간적으로 높은 성능을 요구하는 작업을 할 때 메인보드의 최대 설계 전력인 65W의 전력을 잠깐 동안 사용할 것이다. 이 상태로 Cinebench R23을 돌린 결과는 다음과 같았다.

| i5-9600K             | 95W 순정 | 45W 전력제한 |
|----------------------|----------|----------|
| Cinebench R23 Single | 1200     | 1150     |
| Cinebench R23 Multi  | 6600     | 5800     |

싱글스레드의 경우, 어차피 싱글스레드 혼자서는 45W 모두 사용할 수 없기에 전력제한 후의 점수 차이가 아예 없다(50점은 오차범위 내). 멀티스레드 성능의 경우, 전력은 50%로 제한되었는데, 벤치마크 점수는 10%만 떨어진 것을 확인할 수 있다. Cinebench R23을 돌릴 때에도 CPU 온도가 70도를 넘지 않았으며, 팬 소리도 거의 안 들리다시피 하였다. 결과가 매우 만족스러웠기에, 이렇게 하드웨어 세팅은 마무리하기로 했다.

## 서버 OS 선정
배송받은 PC는 기본적으로 Windows 10이 설치되어 있었지만, 서버용으로 윈도우를 사용하기는 적합하지 않다. 서버가 아닌 일반 사용자들을 위한 OS일 뿐더러, 기본적으로 GUI 환경이 컴퓨터의 자원을 먹기 때문이다. 이 서버에서 사용할 OS로 GCP에서 사용해보아 친숙하던 Linux, 그중에서도 Ubuntu(우분투)를 선택하였다. 서버를 위한 GUI가 없는 버전인 Ubuntu Server 24.04 LTS를 설치하였다. 

![Ubuntu-OpenSSH](/assets/img/ubuntu-openssh.png){: w="500"}
_OpenSSH Server_

여기서 중요한 점은 설치 과정에서 `OpenSSH server`를 자동으로 설치하는 것이 편하다는 점이다. 물론 우분투 설치가 완료되고 나서 OpenSSH를 따로 세팅할 수도 있다. 하지만 우분투 설치 과정에서 설치해놓으면 설치가 완료되자마자 키보드와 모니터 선을 뽑아버리고, 다른 PC에서 서버에 SSH로 접속하여 서버를 조작할 수 있다. 나 역시 우분투 설치가 끝난 후, 공유기와 연결되는 LAN선과 전원선만을 남겨놓고, 관리는 메인PC에서 SSH로 접속하여 서버를 관리하고 있다.

### CasaOS 설치
CasaOS는 사실 일반적으로 말하는 OS는 아니고, 리눅스 서버를 WebUI 형식으로 간편히 관리할 수 있도록 해주는 솔루션이다. 사용하기 매우 간편하기에 홈서버 구축용으로 자주 추천되고 있다. CasaOS는 커뮤니티 기반의 오픈소스 플랫폼이라, 유저들이 만든 다양한 확장 기능(앱)들을 사용할 수 있다. App Store에서 스트리밍 미디어 서버, 개인 클라우드, 사진 백업 등의 다양한 앱들을 받을 수 있다. 

``` bash
curl -fsSL https://get.casaos.io | sudo bash
```

우분투에서 다음과 같은 명령어로 CasaOS를 설치할 수 있다. 유저 계정과 포트 등 이것저것 설정을 마치고 나면, 웹으로 접속하여 다음과 같은 화면을 통해 서버를 간편히 관리할 수 있다.

![CasaOS](/assets/img/casaos.png){: w="500"}
_CasaOS 홈_

## 마무리하며
드디어 내서버마련의 꿈을 이루었다. 여기까지 하드웨어와 기본 OS 세팅은 완료했다. 다음 포스팅에서는 포트포워딩, TailScale을 이용한 서버 외부에서도 서버에 접속하는 방법, SMB(Samba)를 이용한 파일 관리, Crafty Controller를 이용한 마인크래프트 서버 구축 등과 관련한 내용을 이야기 할 것이다. 